rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // ğŸ”¹ è‡ªåˆ†ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ã®ã¿èª­ã¿æ›¸ãå¯èƒ½
    match /users/{userId} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }

    // ğŸ”¹ ã‚·ãƒ•ãƒˆå¸Œæœ›ãƒ‡ãƒ¼ã‚¿ï¼ˆschedulesï¼‰ã®ãƒ«ãƒ¼ãƒ«
    match /schedules/{scheduleId} {
      // ğŸ”¹ æ–°è¦ä½œæˆæ™‚ï¼šè‡ªåˆ†ã®ã‚·ãƒ•ãƒˆå¸Œæœ›ã‚’ä½œæˆOK
      allow create: if request.auth != null && request.resource.data.userId == request.auth.uid;

      // ğŸ”¹ æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿å–ã‚Šãƒ»æ›´æ–°ï¼šè‡ªåˆ†ã®ã‚·ãƒ•ãƒˆå¸Œæœ›ã®ã¿OK
      allow read, update, delete: if request.auth != null && resource.data.userId == request.auth.uid;

       allow read: if request.auth != null;  // èªè¨¼æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼ãªã‚‰å–å¾—ã§ãã‚‹
      allow write: if request.auth != null && request.auth.uid == resource.data.userId;  // ä½œæˆè€…ã®ã¿ç·¨é›†å¯èƒ½
    }
  }
}